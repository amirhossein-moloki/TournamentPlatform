# برنامه جامع توسعه فرانت‌اند برای پلتفرم مسابقات

این فایل یک راهنمای کامل برای توسعه‌دهنده فرانت‌اند است تا بتواند یک رابط کاربری جامع، تعاملی و مدرن برای پلتفرم مسابقات، بر اساس API و مستندات موجود، ایجاد کند.

## بخش ۱: راه‌اندازی اولیه و ساختار پروژه

**هدف:** ایجاد زیرساخت‌های قوی و مقیاس‌پذیر برای پروژه.

### صفحات و کامپوننت‌ها:
- **ابزارها:** React (با Vite)، TypeScript، Tailwind CSS.
- **ساختار پوشه‌ها:** یک ساختار ماژولار مبتنی بر ویژگی (features).
- **مسیریابی:** با `react-router-dom`، شامل مسیرهای عمومی و مسیرهای محافظت‌شده (`ProtectedRoute`).
- **مدیریت وضعیت:** Zustand یا Redux Toolkit.
- **ارتباط با API:** یک سرویس Axios با interceptor برای مدیریت توکن JWT و تازه‌سازی خودکار آن.

### API های مورد استفاده:
- در این مرحله مستقیماً API استفاده نمی‌شود، اما زیرساخت برای فراخوانی آن‌ها آماده می‌شود.

## بخش ۲: احراز هویت و مدیریت پروفایل کاربر

**هدف:** پیاده‌سازی کامل چرخه حیات کاربر از ثبت‌نام تا خروج.

### صفحات و کامپوننت‌ها:
- **صفحه ثبت‌نام (`/register`):** فرمی برای ثبت‌نام کاربر جدید.
- **صفحه ورود (`/login`):** فرمی برای ورود کاربر.
- **صفحه پروفایل (`/profile`):** نمایش اطلاعات کاربر و فرم ویرایش پروفایل.
- **صفحه تایید ایمیل (`/verify-email/:token`):** صفحه‌ای برای نهایی کردن فرآیند تایید ایمیل.
- **اعلان تایید ایمیل:** یک بنر در بالای سایت برای کاربرانی که ایمیل خود را تایید نکرده‌اند.

### API های مورد استفاده:
- `POST /auth/register`
- `POST /auth/login`
- `POST /auth/logout`
- `GET /users/me`
- `PUT /users/me`
- `POST /auth/request-verification-email`
- `POST /auth/verify-email`

## بخش ۳: مسابقات و بازی‌ها (Tournaments & Matches)

**هدف:** ایجاد قابلیت‌های اصلی پلتفرم برای مشاهده، ثبت‌نام و گزارش نتایج مسابقات.

### صفحات و کامپوننت‌ها:
- **صفحه لیست مسابقات (`/tournaments`):** نمایش تمام مسابقات با قابلیت فیلتر، مرتب‌سازی و صفحه‌بندی.
- **صفحه جزئیات مسابقه (`/tournaments/:id`):** نمایش اطلاعات کامل یک مسابقه، لیست شرکت‌کنندگان و براکت (Bracket) بصری.
- **فرم ارسال نتیجه (به صورت Modal یا صفحه جدا):** فرمی برای شرکت‌کنندگان جهت ارسال برنده و اسکرین‌شات نتیجه.

### API های مورد استفاده:
- `GET /tournaments` (با پارامترهای کوئری)
- `GET /tournaments/{id}` (با `include=participants,matches`)
- `POST /tournaments/{id}/register`
- `GET /matches/{id}`
- `POST /matches/{id}/results/upload-url` (برای دریافت URL آپلود)
- `POST /matches/{id}/results` (برای ارسال نهایی نتیجه)

## بخش ۴: ارتباطات بی‌درنگ (Real-time) با Socket.IO

**هدف:** ایجاد یک تجربه کاربری پویا با آپدیت‌های آنی.

### صفحات و کامپوننت‌ها:
- **سرویس `socketService`:** یک ماژول مرکزی برای مدیریت اتصال و احراز هویت سوکت.
- **کامپوننت چت (`ChatWindow`):** قابل استفاده در لابی مسابقات برای چت آنی.
- **آپدیت آنی براکت:** در صفحه جزئیات مسابقه، براکت باید بدون رفرش صفحه به‌روز شود.
- **سیستم نوتیفیکیشن سراسری:** نمایش اعلان‌های آنی (toast notifications) به کاربر.

### رویدادهای Socket.IO مورد استفاده:
- **اتصال:** `connect`, `disconnect` (با ارسال توکن در `auth`).
- **چت:** `joinRoom`, `leaveRoom`, `sendMessage` (emit) | `newMessage`, `userJoined`, `userLeft` (on).
- **مسابقات:** `subscribeToTournamentUpdates`, `unsubscribeFromTournamentUpdates` (emit) | `bracketUpdate`, `tournamentStatusUpdate` (on).
- **نوتیفیکیشن:** `notification` (on).

## بخش ۵: سایر ویژگی‌ها

**هدف:** تکمیل پلتفرم با افزودن قابلیت‌های کلیدی دیگر.

### صفحات و کامپوننت‌ها:
- **صفحه لیدربورد (`/leaderboards`):** نمایش رتبه‌بندی بازیکنان با فیلترهای مختلف.
- **صفحه کیف پول (`/wallet`):** نمایش موجودی، تاریخچه تراکنش‌ها، فرم واریز و فرم برداشت.
- **پنل ادمین (`/admin`):**
    - **مدیریت کاربران (`/admin/users`):** لیست، ایجاد، ویرایش و حذف کاربران.
    - **مدیریت بازی‌ها (`/admin/games`):** مدیریت بازی‌های پلتفرم.
    - **مدیریت مسابقات (`/admin/tournaments`):** ایجاد و نظارت بر مسابقات.

### API های مورد استفاده:
- `GET /leaderboards`
- `GET /wallet`, `GET /wallet/history`
- `POST /wallet/deposit/initialize` (با هدر `X-Idempotency-Key`)
- `POST /wallet/withdrawals` (با هدر `X-Idempotency-Key`)
- تمام اندپوینت‌های مربوط به ادمین (`/users`, `/games`, `/tournaments` در بخش ادمین).

## بخش ۶: تست و استقرار

**هدف:** تضمین کیفیت و در دسترس قرار دادن برنامه.

### رویه‌ها:
- **تست:** نوشتن تست‌های واحد و یکپارچه‌سازی با استفاده از **Jest** و **React Testing Library**. شبیه‌سازی API ها با **Mock Service Worker (MSW)**.
- **استقرار:**
    - ایجاد نسخه build بهینه‌سازی شده.
    - استفاده از پلتفرم **Vercel** یا **Netlify** برای استقرار خودکار (CI/CD) از طریق Git.
    - مدیریت متغیرهای محیطی (مانند آدرس API) در داشبورد پلتفرم استقرار.
